% CODE FOR SIMULATION OF ORIGAMI SHEETS WITH SMOOTH ELASTIC FOLDS
% AUTHOR: Edwin A. Peraza Hernandez
% 05-16-2016
% PAPER DOI: http://dx.doi.org/10.1016/j.cad.2016.05.010

function wstr = WSTR(tet, w0, ord)
% PARAMETER w
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% INPUTS
%
% tet: Fold angle
% w0: Fold width
% ord: Order of geometric continuity
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% OUTPUTS
%
% wstr: Parameter w
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

if ord == 2
    tetv = [0
        0.006666658586978
        0.086838321599923
        0.167013591388354
        0.247196355923026
        0.327388209236990
        0.407593236420503
        0.487814020485826
        0.568050198652115
        0.648305466156534
        0.728579963667038
        0.808874253528664
        0.889188873790280
        0.969520895654667
        1.049871286981860
        1.130239211365192
        1.210621265659852
        1.291013051414412
        1.371412335912937
        1.451811892030542
        1.532204801263778
        1.612579423238171
        1.692920176049683
        1.773208524917324
        1.853416001604170
        1.933510300899793
        2.013444081755901
        2.093161128448454
        2.172591740371548
        2.252332338244868
        2.332700428336183
        2.413078429706787
        2.493460080887116
        2.573836733440388
        2.654196248905447
        2.734522949710178
        2.814796217515662
        2.894989265483742
        2.975067745023225
        3.054987894133609
        3.134694380369741];
    
    wsv = [1
        0.999997151178165
        0.999536723618141
        0.998287333539753
        0.996250266777029
        0.993429588536833
        0.989828501763023
        0.985451627901124
        0.980307121770859
        0.974400872962066
        0.967741679499695
        0.960339144427352
        0.952203825706266
        0.943347021027747
        0.933781078504880
        0.923518910758977
        0.912574396191819
        0.900961802770300
        0.888695721476693
        0.875792168138943
        0.862265968960571
        0.848134059631927
        0.833413544858688
        0.818121704803664
        0.802277587664651
        0.785900965285758
        0.769014110130503
        0.751641129169029
        0.733809369936444
        0.715468673070941
        0.696616605820082
        0.677352736953007
        0.657702470874341
        0.637692340096050
        0.617350158807618
        0.596705062201926
        0.575787764180929
        0.554630781584151
        0.533268700799863
        0.511738505931383
        0.490079979872701];
elseif ord == 1
    tetv = [0
        0.009999982015178
        0.096741484186876
        0.183482829160566
        0.270223890311641
        0.356964555138840
        0.443704740257790
        0.530444363162459
        0.617183402395191
        0.703921631645579
        0.790658896004977
        0.877394572355319
        0.964127471689351
        1.050855274539180
        1.137574146394661
        1.224277551337733
        1.310955324940215
        1.397591754905712
        1.484164183939299
        1.570640082542924
        1.656974477171586
        1.743106687777833
        1.828956894664122
        1.914422725188292
        1.999376256175036
        2.083662018424324
        2.167096283229539
        2.249469375583683
        2.330549797501129
        2.410092120592803
        2.487847292857084
        2.563575004154518
        2.637056172511649
        2.708104624369930
        2.776575695310156
        2.842371222095462
        2.905440516192973
        2.965777791583979
        3.023416785401547
        3.078423890729439
        3.130890711705769];
    
    wsv = [1
        0.999994758507026
        0.999609587864824
        0.998596494355642
        0.996957467534168
        0.994694373730924
        0.991809770737685
        0.988306879025338
        0.984189672254147
        0.979462582364194
        0.974130901359849
        0.968200322831269
        0.961677086181778
        0.954567836847234
        0.946879688052472
        0.938620025550166
        0.929796581170213
        0.920417357715021
        0.910490987939067
        0.900026623704343
        0.889034432481244
        0.877526035958014
        0.865515151340765
        0.853018403477653
        0.840056283880087
        0.826654198197258
        0.812843495261075
        0.798662329761326
        0.784156166980857
        0.769377743738077
        0.754386346101790
        0.739246336483917
        0.724025061046427
        0.708790284278105
        0.693607560044619
        0.678537804670588
        0.663635362944089
        0.648946746258341
        0.634510034727055
        0.620354903761412
        0.606503108734359];
end
costetv = cos(tetv);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTERPOLATING PARAMETER w
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
wstr = (interp1(costetv, wsv, ...
    cos(tet),'pchip')) * w0;