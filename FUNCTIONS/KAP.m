% CODE FOR SIMULATION OF ORIGAMI SHEETS WITH SMOOTH ELASTIC FOLDS
% AUTHOR: Edwin A. Peraza Hernandez
% 05-16-2016
% PAPER DOI: http://dx.doi.org/10.1016/j.cad.2016.05.010

function Kap = KAP(tet, w0, ord)
% Maximum curvature
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% INPUTS
%
% tet: Fold angle
% w0: Fold width
% ord: Order of geometric continuity
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% OUTPUTS
%
% Kap: Maximum curvature
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
if ord == 2
    tetv = [0
        0.006666658586978
        0.086838321599923
        0.167013591388354
        0.247196355923026
        0.327388209236990
        0.407593236420503
        0.487814020485826
        0.568050198652115
        0.648305466156534
        0.728579963667038
        0.808874253528664
        0.889188873790280
        0.969520895654667
        1.049871286981860
        1.130239211365192
        1.210621265659852
        1.291013051414412
        1.371412335912937
        1.451811892030542
        1.532204801263778
        1.612579423238171
        1.692920176049683
        1.773208524917324
        1.853416001604170
        1.933510300899793
        2.013444081755901
        2.093161128448454
        2.172591740371548
        2.252332338244868
        2.332700428336183
        2.413078429706787
        2.493460080887116
        2.573836733440388
        2.654196248905447
        2.734522949710178
        2.814796217515662
        2.894989265483742
        2.975067745023225
        3.054987894133609
        3.134694380369741];
    
    ndkapv = [0
        0.010000000000000
        0.130256410256410
        0.250512820512821
        0.370769230769231
        0.491025641025641
        0.611282051282051
        0.731538461538462
        0.851794871794872
        0.972051282051282
        1.092307692307692
        1.212564102564103
        1.332820512820513
        1.453076923076923
        1.573333333333334
        1.693589743589744
        1.813846153846154
        1.934102564102564
        2.054358974358974
        2.174615384615385
        2.294871794871795
        2.415128205128205
        2.535384615384615
        2.655641025641025
        2.775897435897436
        2.896153846153846
        3.016410256410257
        3.136666666666667
        3.256923076923077
        3.377179487179487
        3.497435897435898
        3.617692307692308
        3.737948717948718
        3.858205128205128
        3.978461538461539
        4.098717948717948
        4.218974358974359
        4.339230769230769
        4.459487179487179
        4.579743589743591
        4.700000000000000];
elseif ord == 1
    tetv = [0
        0.009999982015178
        0.096741484186876
        0.183482829160566
        0.270223890311641
        0.356964555138840
        0.443704740257790
        0.530444363162459
        0.617183402395191
        0.703921631645579
        0.790658896004977
        0.877394572355319
        0.964127471689351
        1.050855274539180
        1.137574146394661
        1.224277551337733
        1.310955324940215
        1.397591754905712
        1.484164183939299
        1.570640082542924
        1.656974477171586
        1.743106687777833
        1.828956894664122
        1.914422725188292
        1.999376256175036
        2.083662018424324
        2.167096283229539
        2.249469375583683
        2.330549797501129
        2.410092120592803
        2.487847292857084
        2.563575004154518
        2.637056172511649
        2.708104624369930
        2.776575695310156
        2.842371222095462
        2.905440516192973
        2.965777791583979
        3.023416785401547
        3.078423890729439
        3.130890711705769];
    ndkapv = [0
        0.010000000000000
        0.096741540150692
        0.183483080301383
        0.270224620452075
        0.356966160602767
        0.443707700753459
        0.530449240904150
        0.617190781054842
        0.703932321205534
        0.790673861356226
        0.877415401506917
        0.964156941657609
        1.050898481808301
        1.137640021958992
        1.224381562109684
        1.311123102260376
        1.397864642411067
        1.484606182561759
        1.571347722712451
        1.658089262863143
        1.744830803013834
        1.831572343164526
        1.918313883315218
        2.005055423465910
        2.091796963616601
        2.178538503767293
        2.265280043917985
        2.352021584068676
        2.438763124219368
        2.525504664370060
        2.612246204520752
        2.698987744671443
        2.785729284822135
        2.872470824972826
        2.959212365123518
        3.045953905274210
        3.132695445424902
        3.219436985575594
        3.306178525726285
        3.392920065876977];
end
costetv = cos(tetv);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INTERPOLATING NON-DIMENSIONAL MAXIMUM CURVATURE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
NDkap = interp1(costetv, ndkapv, ...
    cos(tet),'pchip');
	
Kap = NDkap/w0; % CALCULATING MAXIMUM CURVATURE